# Система семейных отношений с NPC — детальная версия

**Статус:** draft  \
**Версия:** 0.1.0  \
**Дата создания:** 2025-11-07  \
**Последнее обновление:** 2025-11-07  \
**Приоритет:** высокий

**api-readiness:** needs-work  \
**api-readiness-check-date:** 2025-11-07 20:53  \
**api-readiness-notes:** Детализированы семейные структуры, события и их влияние на социальные системы. Требуется баланс и UX-проработка перед постановкой API задач.

---

## 1. Методика детализации

- **Слои:** структура семьи, эмоциональные связи, события, квесты, наследование, влияние на фракции.
- **Роли:** Родитель, Ребенок, Брат/Сестра, Супруг/Партнер, Опекун, Подопечный, Расширенная семья, Клан.
- **Модули:** `social-service` (отношения, доверие, семейные статусы), `world-service` (события, обновления мира), `character-service` (биография NPC), `economy-service` (наследство, ресурсы), `gameplay-service` (квесты, миссии), `factions-service` (династии, влияние).
- **Интерфейсы:** дерево семьи, карточки членов семьи, журналы событий, предупреждения.

---

## 2. Семейные структуры

- **Ядро:** родители, дети, супруги/партнёры.
- **Расширение:** бабушки/дедушки, дяди/тёти, кузены, приёмные связи.
- **Кланы:** фамильные кланы, объединяющие несколько семей (поддержка фракций, бизнесов).
- **Опека:** опекуны и подопечные (включая сирот, спасённых NPC, роботов).
- **Связи:** родственные и брачные отношения, их состояние (активно, напряжено, разорвано).

### 2.1 Атрибуты члена семьи

- **ID, имя, возраст, статус** (жив, пропал, погиб).
- **Профессия, фракция, местоположение.**
- **Отношение к игроку** (репутация, доверие, эмоции).
- **Секреты:** скрытая информация, раскрывающаяся через квесты.

---

## 3. Эмоциональные и социальные уровни

- **Базовое отношение:** как в `npc-relationships-system-детально.md`, но с повышенными коэффициентами.
- **Эмоции:** семейная привязанность, тревога, гордость, грусть, гнев.
- **Доверие:** влияет на доступ к семейным секретам, ресурсам, помощи.
- **Лояльность к клану:** определяет готовность NPC участвовать в семейных миссиях.

### 3.1 Дерево эмоций

- Комбинации эмоций определяют поведение (например, «гордость + тревога» → NPC просит помощи).
- События вызывают сдвиги (свадьба, болезнь, похищение, победа).

---

## 4. События семейной жизни

- **Свадьбы и союзы:** меняют связи, дают бонусы, создают квесты.
- **Рождение/усыновление:** новые NPC, изменение статуса, потребность в ресурсах.
- **Болезнь/кризис:** запрос помощи, запуск медицинских/экономических миссий.
- **Конфликты:** споры о наследстве, идеологии, фракциях.
- **Трагедии:** смерть, похищение, пропажа — сильное влияние на отношения.
- **Праздники:** семейные события, улучшение отношений, подарки.

Каждое событие имеет триггеры, последствия, связанные квесты и визуальные сигнализации.

---

## 5. Взаимодействие игрока с семьёй NPC

- **Диалоги:** дополнительные ветки в зависимости от отношения, статуса семьи.
- **Помощь:** доставка лекарств, защита, участие в свадьбах.
- **Подарки:** семейные реликвии, предметы, влияющие на эмоции.
- **Посещения:** семейные дома, встречи, VR-воспоминания.
- **Медиатор:** решение споров между членами семьи.

### 5.1 Семейные квесты и цепочки

- **Помощь:** лечебные, логистические, эмоциональные.
- **Конфликты:** выбор стороны, переговоры, акции.
- **Воссоединение:** поиск пропавших, возвращение членов.
- **Тайны:** расследования, раскрытие правды.
- **Династии:** многопоколенные цепочки, влияющие на фракции.

---

## 6. Усыновление и вступление в семью

- **Условия:** высокая репутация, квесты, ресурсы.
- **Процесс:** согласие NPC, разрешение фракции, церемония.
- **Последствия:** NPC становится частью «семьи игрока», появляются семейные квесты, доступ к ресурсам.
- **Игрок в семье NPC:** может стать «приёмным сыном/дочерью», получить поддержку, обязанности.

---

## 7. Наследование и ресурсы

- **Наследство:** имущество, компании, акции, тайники.
- **Завещания:** выбор наследников, условия, квесты на подтверждение.
- **Споры:** суды, переговоры, силовые решения.
- **Экономика:** налоги, фракционные проверки, влияние на `economy-service`.

---

## 8. Влияние на фракции и мир

- **Клановые союзы:** семьи входят в союзы корпораций/банд, предоставляют ресурсы.
- **Политика:** семейные решения меняют дипломатические связи.
- **Общественное мнение:** новости, медиа, кампании.
- **Города:** семейные дома, районные события, семейные бренды.

---

## 9. UX и визуализация

- **Дерево семьи:** интерактивное, с фильтрами, историей событий.
- **Календарь:** важные даты (дни рождения, юбилеи, церемонии).
- **Журнал:** хронология взаимодействий, эмоций, квестов, решений.
- **Оповещения:** уведомления о событиях, просьбах, конфликтах.
- **VR-архив:** воспоминания, записи.

---

## 10. Связи с другими системами

- `relationships-system-детально.md` — базовая репутация и доверие.
- `npc-relationships-system-детально.md` — эмоции и романтика.
- `mentorship-system-детально.md` — наставничество внутри семьи.
- `npc-hiring-system-детально.md` — семейный бизнес и найм родственников.
- `player-orders-system-детально.md` — семейные поручения.
- `visual-style-assets-детально.md` — визуальные черты семей.

---

## 11. Использование документа

- Использовать при разработке API для семейных событий, связей, наследования.
- Подготовить UX/UI (дерево семьи, журналы, уведомления).
- Связать с нарративными сюжетами, фракционными войнами, экономикой.
- Провести баланс влияния семей на отношения, экономику и фракции.


