# Инструкция проверки готовности документов .BRAIN

**Цель:** Проверять документы в .BRAIN и определять их готовность к созданию API задач для API-SWAGGER.

**Минимальный вход:**
1. ПРАВИЛО: `.BRAIN/.cursor/rules/brain-readiness-checker-rules.mdc`
2. ИНСТРУКЦИЯ: Этот файл
3. ДОКУМЕНТ: Любой markdown файл из .BRAIN

---

## Процесс работы

### Шаг 1: Сканирование документов

**Что нужно сделать:**
1. Найти все markdown файлы в `.BRAIN` (кроме README.md, ARCHITECTURE.md и других служебных)
2. Игнорировать файлы в директориях:
   - `.cursor/` - служебные файлы
   - `scripts/` - скрипты
   - `06-tasks/` - файлы задач (но config можно проверять)
3. Фокусироваться на файлах в:
   - `01-concepts/` - концепции (могут быть not-applicable)
   - `02-gameplay/` - игровые механики (обычно ready/needs-work)
   - `03-lore/` - лор (может быть ready для API)
   - `04-narrative/` - повествование (может быть ready для API)
   - `05-technical/` - технические документы (может быть ready)

---

### Шаг 2: Анализ документа

**Что проверить:**

1. **Метаданные документа:**
   - Есть ли статус документа? (draft, review, approved)
   - Есть ли версия? (v1.0.0, v2.0.0 и т.д.)
   - Есть ли дата создания и обновления?
   - Есть ли приоритет?

2. **Содержание документа:**
   - Содержит ли документ конкретные механики/концепции?
   - Или это только общее описание без деталей?
   - Есть ли примеры и детализация?
   - Структурирован ли документ?

3. **TODO блоки:**
   - Есть ли TODO блоки?
   - Критичны ли они для создания API?
   - Блокируют ли создание API?

4. **Зависимости:**
   - Есть ли ссылки на другие документы?
   - Завершены ли эти документы?
   - Критичны ли зависимости для создания API?

---

### Шаг 3: Применение критериев готовности

**Критерии готовности (все должны быть проверены):**

#### Критерий 1: Статус документа
- ✅ `approved` - готов к проверке на готовность
- ✅ `review` - может быть готов, но нужно проверить
- ⚠️ `draft` - обычно не готов (но может быть готов, если содержит детали)

**Правило:** Документ должен иметь статус `approved` или `review` для статуса `ready`. Если `draft`, то обычно `needs-work`, но можно сделать исключение, если документ очень детальный.

#### Критерий 2: Полнота информации
- ✅ Документ содержит достаточно деталей для создания API спецификации
- ✅ Описаны механики, правила, ограничения
- ✅ Есть примеры (если применимо)
- ⚠️ Документ слишком общий, нет деталей

**Правило:** Для создания API нужно понимать:
- Какие сущности (entities) есть?
- Какие операции (operations) нужны?
- Какие правила (rules) применяются?
- Какие ограничения (constraints) есть?

#### Критерий 3: Отсутствие блокирующих TODO
- ✅ Нет TODO блоков
- ✅ TODO блоки не критичны для API
- ✅ TODO блоки можно игнорировать при создании API
- ⚠️ Есть критичные TODO, которые блокируют создание API

**Правило:** TODO блоки типа "будет проработано позже" - обычно блокируют. TODO блоки типа "добавить примеры" - можно игнорировать.

**Примеры блокирующих TODO:**
- "TODO: Список конкретных корпораций будет проработан позже" - блокирует
- "TODO: Детальная проработка конкретных фракций будет позже" - блокирует

**Примеры неблокирующих TODO:**
- "TODO: Добавить примеры использования" - не блокирует
- "TODO: Добавить иллюстрации" - не блокирует

#### Критерий 4: Конкретность
- ✅ Документ содержит конкретные механики/концепции
- ✅ Есть детализация, примеры
- ✅ Можно определить API endpoints и модели данных
- ⚠️ Документ слишком общий, нет конкретики

**Правило:** Документ должен содержать достаточно информации для определения:
- Какие endpoints нужны?
- Какие модели данных нужны?
- Какие параметры и ответы?

**Примеры готовых документов:**
- Документ о системе стрельбы с описанием выстрелов, оружия, перезарядки
- Документ о системе крафта с описанием рецептов, материалов, процессов

**Примеры неготовых документов:**
- Документ "Обзор фракций" с только общим описанием, без конкретных фракций
- Документ "Концепция персонажей" с только идеями, без механик

#### Критерий 5: Структурированность
- ✅ Документ хорошо структурирован
- ✅ Есть заголовки, разделы
- ✅ Текст понятен и логичен
- ⚠️ Документ плохо структурирован, сложно понять

**Правило:** Документ должен быть понятен для агента-создателя API задач.

#### Критерий 6: Версионирование
- ✅ Документ имеет версию (v1.0.0, v2.0.0 и т.д.)
- ⚠️ Документ не имеет версии (но это не критично)

**Правило:** Версия желательна, но не критична для готовности.

#### Критерий 7: Документация
- ✅ Есть описание концепций
- ✅ Есть примеры (если применимо)
- ✅ Есть связанные документы
- ⚠️ Мало документации, нет примеров

**Правило:** Хорошая документация помогает, но не обязательна для базовой готовности.

#### Критерий 8: Отсутствие зависимостей (если критично)
- ✅ Нет критичных зависимостей
- ✅ Все зависимости завершены
- ⚠️ Есть незавершенные зависимости

**Правило:** Если документ ссылается на другие документы, которые критичны для создания API и они не готовы, статус может быть `blocked`.

---

### Шаг 4: Определение статуса готовности

**Статусы готовности:**

#### `ready` - готов к созданию задачи API
**Условия:**
- Статус документа: `approved` или `review`
- Полнота информации: достаточно деталей для API
- Отсутствие блокирующих TODO: нет критичных TODO
- Конкретность: есть конкретные механики/концепции
- Структурированность: документ понятен

**Примеры:**
- Документ о системе стрельбы с описанием всех механик
- Документ о системе крафта с рецептами и процессами

#### `needs-work` - нужна доработка документа
**Условия:**
- Статус документа: `draft` или документ не завершен
- Недостаточно деталей для создания API
- Есть критичные TODO блоки
- Документ слишком общий

**Примеры:**
- Документ "Обзор фракций" с TODO "будет проработано позже"
- Документ с только общим описанием, без деталей

#### `blocked` - заблокирован зависимостями
**Условия:**
- Есть критичные зависимости от незавершенных документов
- Документ готов, но зависит от других документов

**Примеры:**
- Документ о системе способностей зависит от системы навыков, которая не готова

#### `in-review` - проверяется на готовность
**Условия:**
- Документ проверяется на данный момент
- Временный статус во время проверки

#### `not-applicable` - документ не предназначен для создания API
**Условия:**
- Документ слишком концептуальный, без механик
- Документ описывает только идеи, без деталей
- Документ не содержит информации для API

**Примеры:**
- Документ "Видение проекта" - только концепции
- Документ "Философия дизайна" - только принципы

---

### Шаг 5: Отметка документа

**Что нужно сделать:**

1. **Обновить метаданные документа:**
   Добавить в начало документа (в секцию метаданных):

```markdown
**api-readiness:** ready
**api-readiness-check-date:** 2025-11-02 15:30
**api-readiness-notes:** Документ готов, содержит все необходимые детали для создания API
```

2. **Обновить readiness-tracker.yaml:**
   Добавить или обновить запись о документе

---

### Шаг 6: Обновление трекера

**Формат записи в readiness-tracker.yaml:**

```yaml
documents:
  - path: ".BRAIN/02-gameplay/combat/shooter-mechanics.md"
    status: "ready"
    version: "1.0.0"
    checked: "2025-11-02 15:30"
    checker: "AI Agent"
    notes: "Документ готов, содержит все необходимые детали"
    issues: []
    api_target: "api/v1/gameplay/combat/shooting.yaml"
    
  - path: ".BRAIN/03-lore/factions/factions-overview.md"
    status: "needs-work"
    version: "1.0.0"
    checked: "2025-11-02 15:30"
    checker: "AI Agent"
    notes: "Есть TODO блоки, нужна детализация конкретных фракций"
    issues:
      - "TODO: Список конкретных корпораций будет проработан позже"
      - "TODO: Список конкретных банд будет проработан позже"
    api_target: null
```

### Шаг 7: Обязательный коммит изменений

**ВАЖНО:** После проверки документов **ОБЯЗАТЕЛЬНО** сделать коммит всех изменений.

**Что нужно закоммитить:**
- Обновленные метаданные документов (api-readiness, api-readiness-check-date, api-readiness-notes)
- Обновленный readiness-tracker.yaml со всеми проверенными документами

**Как сделать коммит:**
1. Использовать скрипт autocommit из корня репозитория `.BRAIN`:
   - Windows: `.\scripts\autocommit.ps1 [сообщение]`
   - Linux/Mac: `./scripts/autocommit.sh [сообщение]`
2. Если сообщение не указано, скрипт сгенерирует его автоматически
3. Скрипт автоматически сделает commit и push изменений

**Пример сообщения коммита:**
```
chore: проверка готовности документов .BRAIN к созданию API задач

- Проверены все документы в .BRAIN
- Обновлены метаданные документов с api-readiness статусами
- Обновлен readiness-tracker.yaml со всеми проверенными документами
```

---

## Чеклист проверки готовности

Используй этот чеклист для каждого документа:

### Блок 1: Метаданные
- [ ] Есть статус документа (draft/review/approved)
- [ ] Есть версия документа
- [ ] Есть дата создания/обновления

### Блок 2: Содержание
- [ ] Документ содержит конкретные механики/концепции
- [ ] Есть достаточно деталей для создания API
- [ ] Документ структурирован и понятен

### Блок 3: TODO блоки
- [ ] Нет критичных TODO, блокирующих создание API
- [ ] Все TODO не критичны или можно игнорировать

### Блок 4: Зависимости
- [ ] Нет критичных незавершенных зависимостей
- [ ] Все зависимости завершены (если критичны)

### Блок 5: Оценка готовности
- [ ] Применены все критерии готовности
- [ ] Определен статус готовности
- [ ] Статус обоснован

### Блок 6: Отметка
- [ ] Обновлены метаданные документа
- [ ] Обновлен readiness-tracker.yaml
- [ ] Запись в трекере полная и корректна

### Блок 7: Коммит изменений
- [ ] ОБЯЗАТЕЛЬНО: Сделан коммит всех изменений
- [ ] Использован скрипт autocommit для коммита
- [ ] Закоммичены обновленные метаданные документов
- [ ] Закоммичен обновленный readiness-tracker.yaml
- [ ] Проверка не завершена без коммита изменений

---

## Примеры готовых документов

### Пример 1: Готовый документ (ready)

**Документ:** `.BRAIN/02-gameplay/combat/shooter-mechanics.md`

**Характеристики:**
- Статус: `approved`
- Версия: `v1.0.0`
- Содержит детальное описание механик стрельбы
- Есть описание оружия, выстрелов, перезарядки
- Нет блокирующих TODO
- Хорошо структурирован

**Статус:** `ready`

---

### Пример 2: Нужна доработка (needs-work)

**Документ:** `.BRAIN/03-lore/factions/factions-overview.md`

**Характеристики:**
- Статус: `draft`
- Версия: `v1.0.0`
- Содержит только общее описание фракций
- TODO: "Список конкретных корпораций будет проработан позже"
- TODO: "Список конкретных банд будет проработан позже"
- Нет деталей конкретных фракций

**Статус:** `needs-work`

**Причина:** Блокирующие TODO, недостаточно деталей для создания API

---

### Пример 3: Не применимо (not-applicable)

**Документ:** `.BRAIN/01-concepts/vision.md`

**Характеристики:**
- Статус: `approved`
- Версия: `v1.0.0`
- Содержит только концепции и видение проекта
- Нет конкретных механик
- Нет информации для создания API

**Статус:** `not-applicable`

**Причина:** Документ слишком концептуальный, не содержит механик для API

---

## Частые вопросы

**Q: Что делать, если документ частично готов?**
A: Используй статус `needs-work` с описанием проблем в notes.

**Q: Можно ли создать API задачу для документа со статусом draft?**
A: Обычно нет, но если документ очень детальный и содержит всю необходимую информацию, можно сделать исключение.

**Q: Что делать с зависимостями?**
A: Если зависимости критичны для создания API, используй статус `blocked`. Если можно создать базовую API без зависимостей, используй `ready`.

**Q: Как часто нужно проверять документы?**
A: При создании новых документов, при обновлении существующих документов, периодически для перепроверки.

**Q: Что делать, если документ не предназначен для API?**
A: Используй статус `not-applicable` и не создавай задачу для него.

---

---

## Массовая проверка документов

### Процесс проверки всех документов

**Когда проверять:**
- При создании новых документов
- При обновлении существующих документов
- Периодически для перепроверки готовности
- После изменения статусов документов (draft → review → approved)

**Как проверить все документы:**

1. **Сканирование всех документов:**
   - Найти все markdown файлы в `.BRAIN`
   - Игнорировать служебные файлы (README.md, ARCHITECTURE.md и т.д.)
   - Игнорировать файлы в `.cursor/`, `scripts/`, `06-tasks/` (кроме config)

2. **Проверка каждого документа:**
   - Применить критерии готовности из этой инструкции
   - Определить статус готовности
   - Обновить метаданные документа
   - Добавить/обновить запись в readiness-tracker.yaml

3. **Обновление трекера:**
   - Добавить все проверенные документы в readiness-tracker.yaml
   - Указать статус, дату проверки, заметки
   - Отметить документы со статусом `ready` для создания API задач

4. **Обязательный коммит изменений:**
   - После проверки всех документов **ОБЯЗАТЕЛЬНО** сделать коммит
   - Использовать скрипт autocommit: `.\scripts\autocommit.ps1 [сообщение]` или `./scripts/autocommit.sh [сообщение]`
   - Если сообщение не указано, скрипт сгенерирует его автоматически
   - Сохранить все изменения: обновленные метаданные документов и readiness-tracker.yaml

**Пример команды для AI агента:**
```
Проверь все документы в .BRAIN на готовность к созданию API задач:
1. Сканируй все .md файлы в 01-concepts/, 02-gameplay/, 03-lore/, 04-narrative/, 05-technical/
2. Применяй критерии готовности из readiness-check-guide.md
3. Обновляй метаданные документов и readiness-tracker.yaml
4. Отметь документы со статусом ready для создания задач
5. ОБЯЗАТЕЛЬНО: Сделай коммит изменений через autocommit скрипт
```

---

## Интеграция с другими системами

### Связь с brain-mapping.yaml в API-SWAGGER

**Когда документ готов (status: ready):**
1. Агент-проверяющий отмечает документ как `ready` в readiness-tracker.yaml
2. Агент-создатель задач видит документы со статусом `ready`
3. Агент-создатель задач создает задачу в API-SWAGGER
4. Агент-создатель задач обновляет brain-mapping.yaml в API-SWAGGER
5. Статус документа в readiness-tracker.yaml можно обновить на `task-created`

**Формат связи:**
```yaml
# В readiness-tracker.yaml
- path: ".BRAIN/02-gameplay/combat/shooter-mechanics.md"
  status: "ready"
  api_target: "api/v1/gameplay/combat/shooting.yaml"
  task_created: "2025-11-02 16:00"
  task_id: "API-TASK-001"
```

### Связь с метаданными документов

**Формат метаданных в документах:**
```markdown
**Статус:** draft | review | approved
**Версия:** 1.0.0
**Дата создания:** 2025-11-02
**Последнее обновление:** 2025-11-02
**Приоритет:** высокий

**api-readiness:** ready | needs-work | blocked | in-review | not-applicable
**api-readiness-check-date:** 2025-11-02 15:30
**api-readiness-notes:** Документ готов, содержит все необходимые детали для создания API
```

---

## Быстрый старт

**Для запуска проверки документов:**
- Используй файл [`check-documents-readiness.md`](./check-documents-readiness.md) - краткая инструкция для агента
- Приложи этот файл агенту, когда нужно проверить готовность документов

---

## Полезные ссылки

- [Быстрая инструкция для агента](./check-documents-readiness.md) - файл для прикрепления агенту
- [Правила проверки](../.cursor/rules/brain-readiness-checker-rules.mdc)
- [Трекер готовности](./readiness-tracker.yaml)
- [Маппинг .BRAIN -> задания](../../../API-SWAGGER/tasks/config/brain-mapping.yaml)

