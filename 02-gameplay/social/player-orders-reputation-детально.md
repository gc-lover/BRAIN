# Система заказов — репутация и рейтинг (детально)

**Статус:** draft  \
**Версия:** 0.1.0  \
**Дата создания:** 2025-11-07  \
**Последнее обновление:** 2025-11-07  \
**Приоритет:** высокий

**api-readiness:** needs-work  \
**api-readiness-check-date:** 2025-11-07 21:02  \
**api-readiness-notes:** Детализированы метрики рейтинга заказчиков и исполнителей, decay, санкции. Требуется формализация формул и UX перед постановкой API задач.

---

## 1. Общая схема рейтингов

- **Рейтинги сторон:** отдельные шкалы для заказчика и исполнителя.
- **Состав:** качество выполнения, соблюдение сроков, коммуникация, количество жалоб.
- **Диапазон:** 0–100 (интегрируется в `social-service`).
- **Категории:** Bronze (0–39), Silver (40–64), Gold (65–84), Platinum (85–100).
- **Decay:** рейтинг снижается со временем без активности.

---

## 2. Метрики исполнителя

- **Completion Rate (CR):** процент успешно выполненных заказов.
- **Timeliness (TL):** соблюдение сроков (штраф за задержку, бонус за опережение).
- **Quality (QL):** оценки заказчиков (1–5) по качеству доказательств, отсутствию штрафов.
- **Reliability (RL):** число жалоб, отмен, предательств.
- **Complexity Bonus (CB):** коэф. за сложные заказы (вес трека).

### 2.1 Расчёт (набросок)

```
Score_executor = w_cr * CR + w_tl * TL + w_ql * QL + w_rl * RL + w_cb * CB
```

- **Глобальные веса (по умолчанию):** w_cr = 0.3, w_tl = 0.2, w_ql = 0.25, w_rl = 0.15, w_cb = 0.1.
- **Decay:** финальный результат × decay(t), где t — дни без заказов (например, 1% в день после 14 дней).

---

## 3. Метрики заказчика

- **Payment Reliability (PR):** своевременность оплаты, отсутствие отказов.
- **Brief Quality (BQ):** полнота описания, ясность требований (оценка исполнителей).
- **Dispute Rate (DR):** доля жалоб, конфликтов, арбитражей.
- **Reward Fairness (RF):** соответствие оплаты сложности (аналитика `economy-service`).
- **Repeat Business (RB):** проц. исполнителей, которые повторно берут заказы у заказчика.

### 3.1 Расчёт (набросок)

```
Score_client = v_pr * PR + v_bq * BQ + v_dr * DR + v_rf * RF + v_rb * RB
```

- **Пример весов:** v_pr = 0.3, v_bq = 0.2, v_dr = 0.2, v_rf = 0.15, v_rb = 0.15.
- **Decay:** аналогично исполнителю.

---

## 4. Отзывы и оценки

- **Отзывы:** текст + оценка (1–5) по двум шкалам: «качество» и «коммуникация».
- **Флаги:** исполнитель/заказчик может поставить флаг (позитивный, нейтральный, негативный).
- **Верификация:** `social-service` проверяет на спам, токсичность.
- **Жалобы:** запускают арбитраж, влияют на рейтинг.

---

## 5. Категории и привилегии

- **Bronze:** базовый доступ.
- **Silver:** скидки на комиссии, доступ к дополнительным фильтрам.
- **Gold:** приоритетное размещение заказов, быстрые выплаты.
- **Platinum:** эксклюзивные заказы, прямые приглашения, участие в элитных аукционах.
- **Санкции:** низкий рейтинг → лимиты на создание заказов/участие.

---

## 6. Динамика рейтинга

- **Decay:** рейтинг снижается при бездействии; минимальное значение — 20% от исторического пика.
- **Boost:** успешные серии заказов дают временный буст.
- **Сезонные сбросы:** в конце сезона пленарные обновления, награды.
- **Фракционные влияния:** фракции могут повышать/понижать рейтинг в своих системах.

---

## 7. Арбитраж и безопасность

- **Dispute Handler:** нейтральная организация (NPC) разбирает споры.
- **Штрафы:** понижение рейтинга, финансовые санкции, бан.
- **Защита:** escrow, страховые фонды (`economy-service`).
- **Логи:** все действия записываются для аудита.

---

## 8. UX и визуализация

- **Профиль:** карта рейтингов, диаграммы, отзывы, история.
- **Виджеты:** уровень, значки, предупреждения.
- **Leaderboard:** топ исполнителей/заказчиков по типам заказов.
- **Награды:** медали, титулы, косметика.

---

## 9. Интеграции

- `player-orders-system-детально.md` — общий процесс заказов.
- `relationships-system-детально.md` — доверие и социальные эффекты.
- `npc-hiring-system-детально.md` — рейтинги NPC, выступающих исполнителями.
- `economy-service`, `social-service` — вычисление рейтингов, decay, арбитраж.

---

## 10. Использование

- Применять для API расчёта рейтингов, отображения в UI, арбитража.
- Подготовить UX (профили, графики, уведомления).
- Балансировать веса, decay, пороги категорий.
- Связать с наградами и доступом к эксклюзивным заказам.


